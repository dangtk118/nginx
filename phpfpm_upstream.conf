server {
    status_zone "SLL-Front-Site: PHPFPM";
    listen 8050;
    server_name _;
    location  ^~ / {
        #proxy_pass php:9000;
        set $resp_body "";
        body_filter_by_lua_block {
            local resp_body = string.sub(ngx.arg[1], 1, 1000)
            ngx.ctx.buffered = (ngx.ctx.buffered or "") .. resp_body
            if ngx.arg[2] then
                ngx.var.resp_body = ngx.ctx.buffered
            end
        }
    }
}

server {
    status_zone "Back-81-Site: PHPFPM";
    listen 8051;
    server_name _;
    location  ^~ / {
        #proxy_pass php:9000;
        set $resp_body "";
        body_filter_by_lua_block {
            local resp_body = string.sub(ngx.arg[1], 1, 1000)
            ngx.ctx.buffered = (ngx.ctx.buffered or "") .. resp_body
            if ngx.arg[2] then
                ngx.var.resp_body = ngx.ctx.buffered
            end
        }
    }
}

server {
    status_zone "Rest-Back-83-Site: PHPFPM";
    listen 8052;
    server_name _;
    location  ^~ / {
        #proxy_pass php:9000;
        set $resp_body "";
        body_filter_by_lua_block {
            local resp_body = string.sub(ngx.arg[1], 1, 1000)
            ngx.ctx.buffered = (ngx.ctx.buffered or "") .. resp_body
            if ngx.arg[2] then
                ngx.var.resp_body = ngx.ctx.buffered
            end
        }
        error_log /var/log/nginx/rest/rest-back-error2.log;
        access_log /var/log/nginx/rest/rest-back-access2.log main;
    }
}

server {
    status_zone "Postfixadmin: PHPFPM";
    listen 8053;
    server_name _;
    location  ^~ / {
        proxy_pass php:9000;
        set $resp_body "";
        body_filter_by_lua_block {
            local resp_body = string.sub(ngx.arg[1], 1, 1000)
            ngx.ctx.buffered = (ngx.ctx.buffered or "") .. resp_body
            if ngx.arg[2] then
                ngx.var.resp_body = ngx.ctx.buffered
            end
        }
    }
}